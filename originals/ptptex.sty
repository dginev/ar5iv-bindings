%===============   PTPTEX.sty   ===================================
%
%                                       ver.0.1     July 29, 1995
%
% based on JJAPTEX.sty for (C) Japanese Journal of Applied Physics
%             Release 2.1, date : 9 September, '94
%
%=================================================================

\typeout{***** Document Style <<PTPTEX.sty>> ver.0.1 ****}

\def\@typeset{\sf typeset using \PTPTeX.sty $<$ver.0.1$>$}
\def\notypesetlogo{\def\@typeset{}}
\def\PTPTeX{\raisebox{-.2ex}{$\cal P$}\kern-.05em{$\cal T$}\kern-.18em%
\raisebox{-.2ex}{$\cal P$}\kern-.03em\TeX}
%\raggedbottom

%%%%%%%%% new %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\mib}[1]{\mbox{\boldmath $#1$}}
\newcommand{\dfrac}[2]{{{\displaystyle{#1}} \over {\displaystyle{#2}}}}
\renewcommand{\thanks}{\footnote}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%       default       ptpbs1.sty      for full paper
%       [letter]      ptpbs2.sty      for letter
%       [preprint]    ptpbs0.sty      for preprint
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\def\@prtstyle{1} \@namedef{ds@preprint}{\def\@prtstyle{0}}
\@namedef{ds@short}{\def\@prtstyle{2}}
\def\ds@twoside{\@twosidetrue \@mparswitchtrue}
\newif\if@seceq \@seceqfalse
\def\ds@seceq{\@seceqtrue}
\@twosidetrue

%%--- optional setting for PTP ---
 \def\@secapp{\secsymbol}  \def\@rm{\rm}
 \def\bgn@center{\begin{center}} \def\end@center{\end{center}}
%%-------------------------------

\@options
\input ptpbs\@prtstyle.sty\relax
%\input cite.sty\relax
%\input subeqn.sty\relax
%\input subeqna.sty\relax

\if@seceq
\@addtoreset{equation}{section}
\def\theequation{\arabic{section}\raise.5ex\hbox{.}\arabic{equation}}
\else
\def\theequation{\arabic{equation}}
\fi

%%%%% Followings are to make Greek Letters italic for PTP %%%%%
%%%%% "70xx are changed into "71xx                        %%%%%
\mathchardef\Gamma="7100
\mathchardef\Delta="7101
\mathchardef\Theta="7102
\mathchardef\Lambda="7103
\mathchardef\Xi="7104
\mathchardef\Pi="7105
\mathchardef\Sigma="7106
\mathchardef\Upsilon="7107
\mathchardef\Phi="7108
\mathchardef\Psi="7109
\mathchardef\Omega="710A
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\def\labelenumi{\arabic{enumi}.}
\def\theenumi{\arabic{enumi}}
\def\labelenumii{(\alph{enumii})}
\def\theenumii{\alph{enumii}}
\def\p@enumii{\theenumi}
\def\labelenumiii{\roman{enumiii}.}
\def\theenumiii{\roman{enumiii}}
\def\p@enumiii{\theenumi(\theenumii)}
\def\labelenumiv{\Alph{enumiv}.}
\def\theenumiv{\Alph{enumiv}}
\def\p@enumiv{\p@enumiii\theenumiii}

\def\labelitemi{$\bullet$}
\def\labelitemii{\bf --}
\def\labelitemiii{$\ast$}
\def\labelitemiv{$\cdot$}

\def\verse{\let\\=\@centercr
 \list{}{\itemsep\z \itemindent -1.5em\listparindent \itemindent
 \rightmargin\leftmargin\advance\leftmargin 1.5em}\item[]}
\let\endverse\endlist
\def\quotation{\list{}{\listparindent 1.5em
 \itemindent\listparindent
 \rightmargin\leftmargin\parsep 0pt plus 1pt}\item[]}
\let\endquotation=\endlist
\def\quote{\list{}{\rightmargin\leftmargin}\item[]}
\let\endquote=\endlist

\def\descriptionlabel#1{\hspace\labelsep \bf #1}
\def\description{\list{}{\labelwidth\z@ \itemindent-\leftmargin 
\itemindent -1em
\labelsep 0pt \leftmargin 1em \itemsep 10pt
\let\makelabel\descriptionlabel}}
\let\enddescription\endlist
\newdimen\descriptionmargin
\descriptionmargin=3em

\arraycolsep 6pt \tabcolsep 6pt \arrayrulewidth \hruleheight 
\tabbingsep \labelsep

\skip\@mpfootins = \skip\footins
\fboxsep = 3pt \fboxrule = .4pt

\newcounter {section}
\newcounter {subsection}[section]
\newcounter {subsubsection}[subsection]

\def\thesection {\arabic{section}}
\def\thesubsection {\@rm \arabic{section}.\arabic{subsection}.}
\def\thesubsubsection {\@rm \thesubsection\arabic{subsubsection}.}

\font\tensyb=cmbsy10\relax
\def\secsymbol{\mbox{\tensyb\symbol{'170}}}
%\if 0\@prtstyle 
%    \def\secsymbol{\mbox{\tensyb\symbol{'170}}}
% \else 
%    \def\secsymbol{\mbox{\tensyb\symbol{'170}}}

\def\@pnumwidth{1.55em}
\def\@tocrmarg {2.55em}
\def\@dotsep{4.5}
\setcounter{tocdepth}{2}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\def\thebibliography#1{\vskip1.5\baselineskip
\bgn@center \refsize 
\@hangfrom{\hskip 0pt}{\interlinepenalty \@M {\bf References}\par}
\end@center \vskip .5\baselineskip \refsize 
\list{\arabic{enumi})}{\settowidth
 \labelwidth{#1)} \leftmargin\labelwidth
 \advance\leftmargin\parindent \advance\leftmargin\labelsep
 \usecounter{enumi}}
 \def\newblock{\hskip .11em plus .33em minus .07em}
 \sloppy\clubpenalty4000\widowpenalty4000
 \sfcode`\.=1000\relax}
\let\endthebibliography=\endlist

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\def\footnoterule{\kern-3\p@
 \hrule width .3\columnwidth height \hruleheight \kern 2.6\p@}

\def\symbolfootnotes{\setcounter{footnote}{0}%
		\gdef\thefootnote{\fnsymbol{footnote}}}
\gdef\@thanks{}\symbolfootnotes
\@addtoreset{footnote}{page}

\long\def\@makefntext#1{%
\parindent 1.5em\noindent \footnotesize %\hskip 0.5em
\hbox to 2.5em{\hss$^{\@thefnmark}$}\hskip3pt#1}

%%%%%%%%% JJAP %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%    definition of footnote mark
%%%%%%%%% JPSJ %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%            modified
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\def\@fnsymbol#1{\ifcase#1\or *\or **\or ***\or
   ****\or *****\or ******\or *******\or ********
   \or ********* \else\@ctrerr\fi\relax}

\def\fnsymbol#1{\@fnsymbol{\@nameuse{c@#1}})}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\setcounter{topnumber}{5}
\def\topfraction{0.9}
\setcounter{bottomnumber}{5}
\def\bottomfraction{0.9}
\setcounter{totalnumber}{7}
\def\textfraction{0.1}
\def\floatpagefraction{0.9}
\setcounter{dbltopnumber}{2}
\def\dbltopfraction{.7}
\def\dblfloatpagefraction{1}

%%%%%%%%% JJAP %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%    definition of @makecaption and tabular environment
%%%%%%%%% PTP %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%            modified
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\def\@tableflag{table}

\long\def\@makecaption#1#2{\captionsize
\ifx\@captype\@tableflag\else \ifdim \topsep=\z@\vskip 0.5\baselineskip \fi\fi
 \setbox\@tempboxa\hbox{#1.\hskip1em#2}
 \ifdim \wd\@tempboxa > \hsize
     \hangindent=2em {#1.\hskip1em#2\par} 
   \else \hbox to \hsize{\hfil\box\@tempboxa\hfil} 
 \fi}

\def\tabular{\vskip.25\baselineskip\tabularsize\def\@halignto{}\@tabular}

\newcounter{figure}
\def\thefigure{\@arabic\c@figure}
\def\fps@figure{htbp}
\def\ftype@figure{1}
\def\ext@figure{lof}
\def\fnum@figure{Fig.\hskip.5em\thefigure}
\def\figure{\@float{figure}}
\let\endfigure\end@float
\newcounter{table}
\def\thetable{\@Roman\c@table}
\def\fps@table{tbhp}
\def\ftype@table{2} 
\def\ext@table{lot}
\def\fnum@table{Table\hskip.5em\thetable}
\def\table{\@float{table}}
\let\endtable\end@float

%%%%%%%%% PTP %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%    \figurebox{width}{height}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\def\figurebox#1#2{% #1: fig-width  #2: fig-height
\begin{center} 
       \fbox{\rule{0cm}{#2}\hspace{#1}}
\end{center}}

%%%%%%%%% JJAP %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%    definition of maketitle
%%%%%%%%% JPSJ %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%            modified
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\def\maketitle{\par
 \begingroup
 \def\thefootnote{\fnsymbol{footnote}}
 %\def\@makefnmark{\hbox to 0pt{$^{\@thefnmark}$\hss}} 
 \if@twocolumn
 \twocolumn[\@maketitle]
 \else \newpage
 \global\@topnum\z@ \@maketitle \fi\thispagestyle{headings}\@thanks
 \endgroup
 %\setcounter{footnote}{0}
 \let\maketitle\relax
 \let\@maketitle\relax
 \gdef\@thanks{}\gdef\@author{}\gdef\@title{}\let\thanks\relax}

%%%% \def\@maketitle was moved into PTPBSx.sty files %%%%

\long\def\inst#1{\long\gdef\@inst{#1}}
\def\pubinfo#1{\gdef\@pubinfo{#1}}
\def\preprintnumber#1{\gdef\@preprtnum{#1}}
\def\recdate#1{\gdef\@recdate{#1}}
\def\abst#1{\gdef\@abst{#1}}

\def\abstract{\if@twocolumn
\section*{Abstract}
\else \small 
\begin{center}
{\bf Abstract\vspace{-.5em}\vspace{0pt}} 
\end{center}
\quotation 
\fi}
\def\endabstract{\if@twocolumn\else\endquotation\fi}

\mark{{}{}}

\def\ps@headings{
\let\@mkboth\markboth
\if 0\@prtstyle
\def\@oddhead{}
\def\@oddfoot{\hbox to \textwidth{\hfil\rm\thepage\hfil%
\makebox[0pt][r]{\@typeset}}}
\else
\def\@oddfoot{\hfil\@typeset}
\def\@oddhead{\hfil\rm\thepage}
\fi}

\def\ps@myheadings{\let\@mkboth\@gobbletwo
\def\@oddhead{\hbox to \textwidth{\hfil\it\rightmark\hfil%
\makebox[0pt][r]{\rm\thepage}}}
\def\@oddfoot{}
\def\@evenhead{\hbox to \textwidth{\makebox[0pt][l]{\rm\thepage}%
\hfil\it\leftmark\hfil}}
\def\@evenfoot{}\def\sectionmark##1{}\def\subsectionmark##1{}}

\def\today{\ifcase\month\or
 January\or February\or March\or April\or May\or June\or
 July\or August\or September\or October\or November\or December\fi
 \space\number\day, \number\year}

\ps@plain \pagenumbering{arabic} \onecolumn 
\if@twoside\else\raggedbottom\fi 
\pagenumbering{arabic} \onecolumn

\def\sloppy{\tolerance=9999 \hfuzz=.5\p@ \vfuzz=.5\p@}

%%%%%%%%% JPSJ %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%    acknowledgements 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\acknowledgement}{\section*{Acknowledgement}}
\newcommand{\acknowledgements}{\section*{Acknowledgements}}

%%%%%%%%% JJAP %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%    definition of @sect for sections
%%%%%%%%% JPSJ, PTP %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%            modified
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\def\@nullstring{}
\def\@appendixstring{Appendix}
\def\@widerule{\rule[.5ex]{2em}{\hruleheight}}

\def\@sect#1#2#3#4#5#6[#7]#8{%
   \ifnum #2>\c@secnumdepth
      \def\@svsec{}
   \else
      \refstepcounter{#1}
      \ifnum #2=1		% TRUE if \section{}
         \ifx\@secapp\@appendixstring
           \ifx\@appendixtitle\@nullstring
             \edef\@svsec{\@secapp~\csname the#1\endcsname\hskip .8em}
           \else
             \edef\@svsec{\@secapp~\csname the#1\endcsname:\hskip .8em}
           \fi
         \else
           \ifx\thesection\@nullstring
             \edef\@svsec{\@secapp \csname the#1\endcsname\hskip .8em}
           \else
             \edef\@svsec{\@secapp \csname the#1\endcsname.\hskip .8em}
           \fi
         \fi
      \else
           \def\@svsec{\csname the#1\endcsname\hskip .8em}
      \fi
   \fi
   \@tempskipa #5\relax
     \ifdim \@tempskipa>\z@
       \begingroup 
           #6\relax
         \ifnum #2=1
           \bgn@center
          % #6\relax
           \ifx\@secapp\@appendixstring
             %\if 0\@prtstyle
          %  \@hangfrom{\hskip #3\relax\@svsec}{\interlinepenalty \@M #8\par}%
             %\else
               {\@secapp~\csname the#1\endcsname}
               \par \vskip -.1\baselineskip \it
               {\interlinepenalty \@M \normalsize\it
               \@widerule\ #8\ \@widerule \par}%
             %\fi
           \else
       \@hangfrom{\hskip #3\relax\@svsec}{\interlinepenalty \@M #8\par}%
           \fi
           \end@center
         \else
         %  #6\relax
        \@hangfrom{\hskip #3\relax\@svsec}{\interlinepenalty \@M #8\par}%
         \fi
       \endgroup
       \csname #1mark\endcsname{#7}\addcontentsline
         {toc}{#1}{\ifnum #2>\c@secnumdepth \else
                      \protect\numberline{\csname the#1\endcsname}\fi
                    #7}
     \else
       \def\@svsechd{#6\hskip #3\@svsec #8\csname #1mark\endcsname
                     {#7}\addcontentsline
                        {toc}{#1}{\ifnum #2>\c@secnumdepth \else
                         \protect\numberline{\csname the#1\endcsname}\fi
                     #7}}
     \fi
     \@xsect{#5}}

\def\@ssect#1#2#3#4#5{\@tempskipa #3\relax
   \ifdim \@tempskipa>\z@
     \begingroup \bgn@center
     #4\@hangfrom{\hskip #1}{\interlinepenalty \@M #5\par}
     \end@center \endgroup
   \else \def\@svsechd{#4\hskip #1\relax #5}\fi
    \@xsect{#3}}

%%%%%%%%% JJAP %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%    \appendix
%%%%%%%%% JPSJ %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%            modified
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\def\appendix{\par
 \setcounter{section}{0}
 \setcounter{subsection}{0}
 \def\@secapp{Appendix}
 \@addtoreset{equation}{section}
 \def\theequation{\Alph{section}\raise.5ex\hbox{.}\arabic{equation}}
 \def\thesection{\Alph{section}}
 \def\thesubsection{\@rm\Alph{section}.\arabic{subsection}}}

%%%%%%%%% JJAP %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\def\eqnarray{%
  \stepcounter{equation}%
  \let\@currentlabel=\theequation
  \global\@eqnswtrue
  \global\@eqcnt\z@
  \tabskip\@centering
  \let\\=\@eqncr
  $$\halign to \displaywidth\bgroup\@eqnsel\hskip\@centering
  $\displaystyle\tabskip\z@{##}$&\global\@eqcnt\@ne
  \hfil$\displaystyle{{}##{}}$\hfil
  &\global\@eqcnt\tw@$\displaystyle\tabskip\z@{##}$\hfil
  \tabskip\@centering&\llap{##}\tabskip\z@\cr}

%%%%%%%% PTP %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\if 0\@prtstyle
\pagestyle{plain}
\else
\pagestyle{myheadings}
\fi
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%% The subequations environment %%%%%%%%%%%%%%%%%%%
%
% Within the subequations environment, the only change is that
% equations are labeled differently.  The number stays the same,
% and lower case letters are appended.  For example, if after doing
% three equations, numbered 1, 2, and 3, you start a subequations
% environmment and do three more equations, they will be numbered
% 4a, 4b, and 4c.  After you end the subequations environment, the
% next equation will be numbered 5.
%
% Both text and equations can be put inside the subequations environment.
%
% If you make any improvements, I'd like to hear about them.
%
% Stephen Gildea
% MIT Earth Resources Lab
% Cambridge, Mass. 02139
% mit-erl!gildea
% gildea@erl.mit.edu
%
\newtoks\@stequation

\def\subequations{\refstepcounter{equation}%
  \edef\@savedequation{\the\c@equation}%
  \@stequation=\expandafter{\theequation}%   %only want \theequation
  \edef\@savedtheequation{\the\@stequation}% %expanded once
  \edef\oldtheequation{\theequation}%
  \setcounter{equation}{0}%
  \def\theequation{\oldtheequation\alph{equation}}}

\def\endsubequations{%
  \setcounter{equation}{\@savedequation}%
  \@stequation=\expandafter{\@savedtheequation}%
  \edef\theequation{\the\@stequation}%
  \global\@ignoretrue}

% More from John Hobby
% Fix Plain's \bigl, \Bigl, etc. macros so that they try to scale with
% LaTeX size changes.  This uses the fact that \@setsize sets \ht\strutbox
% to be 70% of the normal unstretched baselineskip.

\def\big#1{{\hbox{$\left#1\vcenter to1.428\ht\strutbox{}\right.\n@space$}}}
\def\Big#1{{\hbox{$\left#1\vcenter to2.142\ht\strutbox{}\right.\n@space$}}}
\def\bigg#1{{\hbox{$\left#1\vcenter to2.857\ht\strutbox{}\right.\n@space$}}}
\def\Bigg#1{{\hbox{$\left#1\vcenter to3.571\ht\strutbox{}\right.\n@space$}}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%% subeqnarray environment %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Subeqnarray DOCUMENT-STYLE option -- Version 1.1 released 15 November 1988
%    for LaTeX version 2.09
%
% Copyright (C) 1988 by Johannes Braams, Dr Neher Laboratories
%
%    This style option defines the subeqnarray and subeqnarray*
%    environment, which behaves like the eqnarray environment,
%    except that the lines are numbered like 1a 1b 1c etc.
%    To refer to these numbers an extra label command \slabel
%    has been defined.
%
%    Many of this code was taken from LaTeX.TeX and modified for
%    this purpose.
%
% Revisions:
%
%    22 December 1988    V1.1    JB    Fixed bug in subeqnarray* environment
%
%-
\typeout{Documentstyle option `subeqnarray' V1.1;  Released 22 December 1988}
%
%    A new counter for he subequations
%    and a command to generate the number
%
\newcounter{subequation}[equation]
\def\thesubequation{\theequation\@alph\c@subequation}
%
%  \@subeqnnum: Produces the equation number for the
%     subeqnarray environment.  The following definition is for
%     flushright numbers; for flushleft numbers, see leqno.doc.
%     The {\rm ... } puts the subequation number in roman type even if
%     an subeqnarray environment appears in an italic environment.
%
\def\@subeqnnum{{\rm (\thesubequation)}}
%
%    A new label command to refer to subequations. It works
%    like the \label command and was taken from LaTeX.TeX
%
%  \slabel{FOO} then writes the following on file \@auxout :
%        \newlabel{FOO}{{eval(\@currentlabel)}{eval(\thepage)}}
%
\def\slabel#1{\@bsphack\if@filesw {\let\thepage\relax
   \xdef\@gtempa{\write\@auxout{\string
      \newlabel{#1}{{\thesubequation}{\thepage}}}}}\@gtempa
   \if@nobreak \ifvmode\nobreak\fi\fi\fi\@esphack}
%
%    Here's the subeqnarray environment,
%        it steps the equation counter,
%        sets the subequation counter equal to 1
%        and behaves much like the eqnarray environment.
%
\def\subeqnarray{\stepcounter{equation}
\let\@currentlabel=\theequation\global\c@subequation\@ne
\global\@eqnswtrue
\global\@eqcnt\z@\tabskip\@centering\let\\=\@subeqncr
$$\halign to \displaywidth\bgroup\@eqnsel\hskip\@centering
  $\displaystyle\tabskip\z@{##}$&\global\@eqcnt\@ne
  \hskip 2\arraycolsep \hfil${##}$\hfil
  &\global\@eqcnt\tw@ \hskip 2\arraycolsep $\displaystyle\tabskip\z@{##}$\hfil
   \tabskip\@centering&\llap{##}\tabskip\z@\cr}

\def\endsubeqnarray{\@@subeqncr\egroup
                     $$\global\@ignoretrue}

\def\@subeqncr{{\ifnum0=`}\fi\@ifstar{\global\@eqpen\@M
    \@ysubeqncr}{\global\@eqpen\interdisplaylinepenalty \@ysubeqncr}}

\def\@ysubeqncr{\@ifnextchar [{\@xsubeqncr}{\@xsubeqncr[\z@]}}

\def\@xsubeqncr[#1]{\ifnum0=`{\fi}\@@subeqncr
   \noalign{\penalty\@eqpen\vskip\jot\vskip #1\relax}}

\def\@@subeqncr{\let\@tempa\relax
    \ifcase\@eqcnt \def\@tempa{& & &}\or \def\@tempa{& &}
      \else \def\@tempa{&}\fi
     \@tempa \if@eqnsw\@subeqnnum\refstepcounter{subequation}\fi
     \global\@eqnswtrue\global\@eqcnt\z@\cr}

% Here's the subeqnarray* environment:

\let\@ssubeqncr=\@subeqncr
\@namedef{subeqnarray*}{\def\@subeqncr{\nonumber\@ssubeqncr}\subeqnarray}
\@namedef{endsubeqnarray*}{\global\advance\c@equation\m@ne%
                           \nonumber\endsubeqnarray}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%% macros  \cite and \citen %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%     CITE.STY -- compress numerical citations.
%     See also OVERCITE.STY.
%
%     Copyright (C) 1989,1990 by Donald Arseneau
%     These macros may be freely transmitted, reproduced, or modified for
%     non-commercial purposes provided that this notice is left intact.
%     
%     Instructions follow \endinput.
%  ------------------------------------
%
%  Pull out the code that writes the aux file citation and formats 
%  the number.  \citen can be used by itself to give citation numbers 
%  without the other formatting; e.g., "See also ref.~\citen{junk}."
%
\def\citen#1{%
\if@filesw \immediate \write \@auxout {\string \citation {#1}}\fi 
\@tempcntb\m@ne \let\@h@ld\relax \def\@citea{}%
\@for \@citeb:=#1\do {%
  \@ifundefined {b@\@citeb}%
    {\@h@ld\@citea\@tempcntb\m@ne{\bf ?}%
    \@warning {Citation `\@citeb ' on page \thepage \space undefined}}%
% else, defined
    {\@tempcnta\@tempcntb \advance\@tempcnta\@ne
    \setbox\z@\hbox\bgroup % check if citation is a number:
    \ifnum0<0\csname b@\@citeb \endcsname \relax
       \egroup \@tempcntb\number\csname b@\@citeb \endcsname \relax
       \else \egroup \@tempcntb\m@ne \fi
    \ifnum\@tempcnta=\@tempcntb % Number follows previous--hold on to it
       \ifx\@h@ld\relax % first pair of successives
          \edef \@h@ld{\@citea\csname b@\@citeb\endcsname}% 
       \else % compressible list of successives
%         % use \hbox to avoid easy \exhyphenpenalty breaks 
          \edef\@h@ld{\hbox{-}\penalty\@highpenalty
%          \edef\@h@ld{\hbox{--}\penalty\@highpenalty
            \csname b@\@citeb\endcsname}%
       \fi
    \else   %  non-successor--dump what's held and do this one
       \@h@ld\@citea\csname b@\@citeb \endcsname 
       \let\@h@ld\relax
    \fi}%
%%    To put space after the comma, use:
 \def\@citea{,\penalty\@highpenalty\hskip.13em plus.1em minus.1em}%
%%    For no space after comma, use:
%% \def\@citea{,\penalty\@highpenalty}% 
%%
}\@h@ld}
% 
%     Replacement for \@citex:
% 
\def\@citex[#1]#2{\@cite{\citen{#2}}{#1}}%
%
%  Replacement for \@cite 
%
\def\@cite#1#2{\leavevmode\unskip
  \ifnum\lastpenalty=\z@\penalty\@highpenalty\fi% highpenalty before
%\ $^{\multiply\@highpenalty 3 #1%             % triple-highpenalties within
   $^{\multiply\@highpenalty 3 #1%             % no space to note by T. Inoue
      \if@tempswa,\penalty\@highpenalty\ #2\fi % and before note.
    )}$\spacefactor\@m}
%
%\endinput
%
%     
%                          CITE.STY
%
%     Modify LaTeX's normal citation mechanism to:
%
%     o Allow, but strongly discourage, line breaks within a series of
%       citations.  Each number is separated by a comma and a small space.
%       A break at the beginning of an optional note is discouraged also.
%
%     o Compress lists of three or more consecutive numbers to one number 
%       range which can be split, with difficulty, after the dash.  No sorting
%       to optimize compression is done.  All numbers should be greater than
%       zero. E.g., if you used to get [5,6,7,9,8,Einstein,6], then this style 
%       will give you [5--7,9,8,Einstein,6]. 
%
%     o Always puts an interword space before the citation and allow a 
%       highpenalty break there (unless you specifically forbid it with ~).
%       E.g.,   Something really stupid \cite{Larry,Curly,Moe}.
%                                      ^-- This space doesn't matter.
%
%     To get just the numbers (and write to the aux file) without the
%     extra formatting, use \citen just like \cite.
%
%     Linebreaks are allowed with triple-highpenalties after dashes
%     and commas; these may have to be taken if TeX sees no other 
%     viable breakpoints.  If you think citations are being split 
%     unnecessarily, try using \sloppy or a sloppypar environment.
%
%     FRAGILE!
%
% Send problem reports to asnd@triumfcl.bitnet or Arseneau@mtsg.ubc.ca
%
% test integrity:
% brackets: round, square, curly, angle:   () [] {} <>
% backslash, slash, vertical, hat, tilde:   \ / | ^ ~
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\endinput
